import"normalize.css";import"./styles/main.scss";document.body.insertAdjacentHTML("afterbegin",'\n    <div class="container">\n        <div class="top">\n                <div class="info__moves-note">Ðœoves: <span class="info__moves">0</span></div>\n                <button class="menu-button">Menu</button>\n                <div class="info__time-note">Time: <span class="info__time">00:00</span></div>\n        </div>\n\n        <div class="menu">\n            <button class="menu__button button_start">New game</button>\n            <button class="menu__button button_save">Save</button>\n            <button class="menu__button button_load">Load</button>\n            <button class="menu__button button_results">Results</button>\n            <span class="menu__text">*You can use arrows to play</span>\n        </div>\n\n        <div class="field">\n            <div class="message">\n            </div>\n        </div>\n\n        <div class="bottom">\n            <div class="radio-button">\n                <input id="radio-3" type="radio" name="radio" value="3">\n                <label for="radio-3">3x3</label>\n            </div>\n            <div class="radio-button">\n                <input id="radio-4" type="radio" name="radio" value="4" checked>\n                <label for="radio-4">4x4</label>\n            </div>\n            <div class="radio-button">\n                <input id="radio-5" type="radio" name="radio" value="5">\n                <label for="radio-5">5x5</label>\n            </div>\n            <div class="radio-button">\n                <input id="radio-6" type="radio" name="radio" value="6">\n                <label for="radio-6">6x6</label>\n            </div>\n            <div class="radio-button">\n                <input id="radio-7" type="radio" name="radio" value="7">\n                <label for="radio-7">7x7</label>\n            </div>\n            <div class="radio-button">\n                <input id="radio-8" type="radio" name="radio" value="8">\n                <label for="radio-8">8x8</label>\n            </div>\n        </div>\n    </div>\n');const menuButton=document.querySelector(".menu-button"),menu=document.querySelector(".menu"),buttonStart=document.querySelector(".button_start"),saveButton=document.querySelector(".button_save"),loadButton=document.querySelector(".button_load"),resultsButton=document.querySelector(".button_results"),timerDisplay=document.querySelector(".info__time"),movesDisplay=document.querySelector(".info__moves"),radioButtons=document.getElementsByName("radio");menuButton.disabled=!0;let isMenuOpen=!0;menuButton.addEventListener("click",(()=>{winCondition?(menuButton.disabled=!0,message.innerHTML="",menu.classList.remove("hidden"),message.classList.remove("hidden"),winCondition=!1,isMenuOpen=!0):isMenuOpen?(timerCounter=setInterval(updateTimer,1e3),menu.classList.add("hidden"),message.classList.add("hidden"),isMenuOpen=!1):(clearInterval(timerCounter),menu.classList.remove("hidden"),message.classList.remove("hidden"),isMenuOpen=!0),radioButtons.forEach((e=>{e.disabled=!e.disabled}))}),!1),buttonStart.addEventListener("click",(()=>{menu.classList.add("hidden"),menuButton.disabled=!1,isMenuOpen=!1,shuffle(),setTimeout((()=>{startTimer(),resetMoves(),message.classList.add("hidden"),message.innerHTML=""}),1200),radioButtons.forEach((e=>{e.disabled=!0}))})),radioButtons.forEach((e=>e.addEventListener("click",(()=>{generateNewField(e),clearInterval(timerCounter),message.innerHTML="",message.classList.remove("hidden"),menu.classList.remove("hidden"),menuButton.disabled=!0}))));let timerCounter,seconds=0,minutes=0,moves=0;function startTimer(){resetTimer(),timerCounter=setInterval(updateTimer,1e3)}function resetTimer(){clearInterval(timerCounter),seconds=0,minutes=0,timerDisplay.innerText="00:00"}function updateTimer(){seconds++,seconds<60&&(timerDisplay.innerText=`${minutes<10?"0"+minutes:minutes}:${seconds<10?"0"+seconds:seconds}`,console.log("tick")),seconds>59&&(seconds=0,minutes++,timerDisplay.innerText=`${minutes}:${seconds}`,console.log("tack")),minutes>59&&alert("Get rest, bro!")}function resetMoves(){moves=0,movesDisplay.innerText="0"}function updateMoves(){moves++,movesDisplay.innerText=`${moves}`}const field=document.querySelector(".field"),animationSpeed=1e3;let mode=4,cellSize=getCellSize(field,mode);function getCellSize(e,t){return e.getBoundingClientRect().width/t}function resizeWidthOnly(e,t){let n=[window.innerWidth];return onresize=function(){let l=window.innerWidth,s=n.length;n.push(l),n[s]!==n[s-1]&&(clearTimeout(t),t=setTimeout(e,50))},e}window.addEventListener("resize",(()=>{cellSize=getCellSize(field,mode),regenerateCells(cells)}),!1),resizeWidthOnly((function(){cellSize=getCellSize(field,mode)}));let message=document.querySelector(".message"),cellsAmount=mode*mode,numbers=[...Array(cellsAmount).keys()],cells=[],empty={value:cellsAmount,top:mode-1,left:mode-1};cells.push(empty);let winCondition=!1;function isFinished(){return cells.every((e=>e.value===e.top*mode+e.left+1))&&(clearInterval(timerCounter),message.classList.remove("hidden"),message.innerHTML=`Hooray!<br> You solved the puzzle <br>in ${minutes}:${seconds} and ${moves} moves!`,isMenuOpen=!1,winCondition=!0),!1}let shuffleTimer,maxShuffleCount=2,shuffleCounter=0,blockedCell=null;function shuffle(){clearInterval(shuffleTimer),0==shuffleCounter&&(shuffleTimer=setInterval((()=>{if(radnomSwap(),shuffleCounter++,shuffleCounter>=maxShuffleCount)return clearInterval(shuffleTimer),void(shuffleCounter=0)}),20)),blockedCell=null}function radnomSwap(){const e=[];for(let t=0;t<cells.length;t++)isValidToSwap(cells[t])&&cells[t]!=empty&&e.push(t);let t=Math.floor(Math.random()*e.length);for(;blockedCell===cells[e[t]];)t=Math.floor(Math.random()*e.length);swap(e[t]),blockedCell=cells[e[t]]}function swap(e){const t=cells[e];isValidToSwap(t)&&(t.element.style.left=empty.left*cellSize+"px",t.element.style.top=empty.top*cellSize+"px",[empty.left,t.left]=[t.left,empty.left],[empty.top,t.top]=[t.top,empty.top],updateMoves()),setTimeout(isFinished,1e3)}function isValidToSwap(e){return!(Math.abs(empty.left-e.left)+Math.abs(empty.top-e.top)>1)}function generateNewField(e){mode=e.value,field.innerHTML="",field.insertAdjacentHTML("afterbegin",'<div class="message"></div>'),message=document.querySelector(".message"),resetTimer(),resetMoves(),cellsAmount=mode*mode,numbers=[...Array(cellsAmount).keys()],cells=[],empty={value:cellsAmount,top:mode-1,left:mode-1},cells.push(empty),cellSize=getCellSize(field,mode),generateCells(numbers),regenerateCells(cells);let t=document.querySelectorAll(".cell");const n={3:12,4:10,5:8,6:7,7:6,8:5};t.forEach((e=>{e.style.fontSize=`${n[mode]}vmin`}))}function regenerateCells(e){for(let t of e)t!=empty&&(t.element.style.left=t.left*cellSize+"px",t.element.style.top=t.top*cellSize+"px",t.element.style.width=100/mode+"%",t.element.style.height=100/mode+"%")}function generateCells(e){let t=0,n=0;for(let l=1;l<cellsAmount;l++){const s=document.createElement("div"),o=e[l-1]+1;s.className="cell",s.innerHTML=o,t==mode&&(t=0,n++),s.style.left=t*cellSize+"px",s.style.top=n*cellSize+"px",s.style.width=100/mode+"%",s.style.height=100/mode+"%",cells.push({value:o,left:t,top:n,element:s}),t++,s.addEventListener("click",(()=>{swap(l)})),field.append(s)}}generateNewField(radioButtons[1]),window.addEventListener("keydown",(e=>{if(e.key.includes("Arrow")&&!isMenuOpen){const t=e.key.split("Arrow")[1].toLowerCase(),n={left:empty.left,top:empty.top};switch(t){case"up":n.top-=1;break;case"down":n.top+=1;break;case"left":n.left-=1;break;case"right":n.left+=1}if(n.left>=mode||n.left<0||n.top>=mode||n.top<0)return;for(let e=0;e<cells.length;e++)cells[e].left===n.left&&cells[e].top===n.top&&swap(e)}}));